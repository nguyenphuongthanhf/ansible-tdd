---
- set_fact:
    atdd_role_name="{{ role_path | basename }}"
    export_vars={{vars}}

- name: Creates test directory
  become: no
  connection: local
  file: path={{playbook_dir}}/.log/verify-roles/info state=directory recurse=true

- name: Creates test directory
  become: no
  connection: local
  file: path={{playbook_dir}}/.log/verify-roles/data state=directory recurse=true

- name: Log info role
  become: no
  connection: local
  template:
    src: "{{lookup('env','ATDD_SOURCE_DIRECTORY')}}/commands/templates/verify_role_info.j2"
    dest: "{{playbook_dir}}/.log/verify-roles/info/{{role_uuid}}.yml"

- name: generate all ansible vars for role {{atdd_role_name}}
  copy: content="{{export_vars |to_nice_json}}" dest={{playbook_dir}}/.log/verify-roles/data/{{role_uuid}}.json
  become: no
  connection: local